# 单容器部署
# 使用方法:
#   1. cp .env.example .env
#   2. 编辑 .env 填写配置
#   3. docker-compose up -d --build

services:
  app:
    build: .
    container_name: news-task
    restart: unless-stopped
    ports:
      - "${PORT:-8000}:8000"
    environment:
      - DEBUG=false
      - DATABASE_URL=sqlite+aiosqlite:///./data/app.db
      - SECRET_KEY=${SECRET_KEY:-change-this-secret-key}
      - SMTP_HOST=${SMTP_HOST:-smtp.qq.com}
      - SMTP_PORT=${SMTP_PORT:-587}
      - SMTP_USER=${SMTP_USER}
      - SMTP_PASSWORD=${SMTP_PASSWORD}
      - SMTP_FROM=${SMTP_FROM}
      - SMTP_TLS=${SMTP_TLS:-true}
      - OPENAI_API_KEY=${OPENAI_API_KEY:-}
      - OPENAI_BASE_URL=${OPENAI_BASE_URL:-https://api.openai.com/v1}
      - OPENAI_MODEL=${OPENAI_MODEL:-gpt-4o-mini}
      - CORS_ORIGINS=["*"]
    volumes:
      - app-data:/app/data

volumes:
  app-data:
